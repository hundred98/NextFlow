# N8N移动端APP需求文档

## 一、核心功能定位
1. **流程监控与管理**
   - 查看核心自动化流程的运行状态——(已完成)
   - 查看流程执行日志和结果——(已完成)
   - 支持快速暂停/启用流程——(已完成)
   - 工作流卡片颜色状态指示器：——(已完成)
     - 运行中状态：绿色背景+绿色指示器
     - 已暂停状态：灰色背景+深灰色指示器
     - 无法自动启动状态：灰色背景+灰色指示器
2. **场景化触发**
   - 基于移动端硬件触发：
     - 位置触发
     - 相机/相册触发
     - 传感器数据触发
   - 基于行为触发：
     - 扫码触发
     - 摇一摇触发
3. **轻量审批与交互**
   - 流程中人工介入的一键审批
   - 数据确认交互入口
4. **设置与配置**
   - n8n服务器URL配置——(已完成)
   - 用户界面设置（主题、语言等）——(语言已完成)
   - 安全设置（应用锁）——(已完成)
   - 系统设置（日志相关配置）——(已完成)
5. **会员系统**
   - 分级会员服务（基础/专业/团队）
   - 功能权限差异化
   - 付费订阅机制

## 二、技术架构建议
### 前端开发
- **技术栈选择**：
  - Flutter或React Native跨平台方案
- **核心交互设计**：
  - 卡片式流程列表展示
  - 下拉刷新更新状态
  - 长按菜单快速操作

### 后端适配
- **API层**：
  - 封装移动端专用接口
  - 优化数据传输效率
- **配套节点开发**：
  - 移动端输入节点(位置/图片/录音)
  - 移动端通知节点
  - 扫码触发节点
- **权限控制**：
  - 新增"移动端角色"
  - 限制可访问流程范围
  - 基于会员等级的功能权限控制

## 三、分阶段实施计划
### 第一阶段(MVP+)
- 功能：
  - 流程列表查看 ✅
  - 基础状态监控 ✅
  - 关键日志查看 ✅
  - 基础设置功能（n8n URL配置、主题设置、安全设置、系统设置）✅
  - 基础会员系统框架（功能权限控制）✅
  - 手动启动/停止工作流功能 ✅
  - 设置页面UI优化（移除重复标题，添加通知设置）✅
- 目标：验证核心交互可行性 ✅

### 第二阶段(核心场景)
- 功能：
  - 硬件触发(位置/扫码)
  - 流程审批功能
  - APP内通知推送
  - 通知设置
  - 本地存储设置
  - 工作流显示设置
  - 专业会员功能解锁
  - 手动触发功能（Webhook GET/Manual Trigger/Form Trigger）- 流程执行触发
- 目标：覆盖核心业务场景

### 第三阶段(体验优化)
- 功能：
  - 自定义流程卡片
  - 日志筛选导出
  - 离线同步优化
  - 多账号切换
  - 高级设置选项（生物识别认证、自动登出时间）
  - 团队/企业会员功能
- 目标：提升用户体验

## 四、安全防护措施
1. **数据传输安全**
   - TLS 1.3加密
   - API请求签名验证

2. **数据存储安全**
   - 敏感信息系统级加密存储
   - 本地数据分级保护

3. **身份认证**
   - 多因素认证(MFA)
   - 精细化权限管控

4. **设备安全**
   - Root/越狱检测
   - APP安全加固
   - 自动锁屏保护

5. **操作审计**
   - 关键操作日志
   - 异常行为拦截

6. **应急响应**
   - 远程账号管控
   - 定期安全更新

## 五、会员系统设计
### 会员等级
1. **基础用户（免费）**
   - 基础监控功能：查看工作流状态、执行日志
   - 有限的手动触发功能
   - 基础通知功能
   - 社区支持

2. **专业用户（付费）**
   - 无限制工作流监控
   - 高级触发器：位置、传感器、相机等硬件触发
   - 完整的手动触发功能
   - 优先通知和提醒
   - 高级安全功能（生物识别、应用锁等）
   - 优先技术支持

3. **团队/企业用户（付费）**
   - 多用户管理
   - 团队协作功能
   - 高级安全控制
   - 专属客户支持
   - 定制化选项

### 技术实现
- 基于JWT的认证机制
- 角色基础访问控制(RBAC)
- 功能模块的权限检查
- 与n8n后端用户系统的集成
- 订阅模式（月付/年付）
- 免费试用期策略
- 灵活的升级/降级机制